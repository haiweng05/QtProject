# Qt作业报告

## 综述
* 我们的项目的目标是实现一个能够满足北大学生尤其是新生个性化需求的日程管理应用，希望借此帮助用户提高效率，关键是尝试走出舒适区，尝试未尝试过的事情，活出多彩的人生。

* 与通常的日程管理软件不同,我们的项目的突出特点在其个性化的设计,希望项目能够帮助有缺乏规划意识的同学提高效率,同时能够降低走出舒适区所需要的各类成本

## 程序功能介绍

### 菜单
* 在菜单界面点击`启动`按钮可以进入主界面

### 主界面

#### 导入课表功能
* 点击`导入课表`按钮,可以从文件资源管理器中打开从选课网或信息门户上下载的`xls/xlsx`格式课表,作为之后日程自动推荐的基础.

* 导入的课表会被自动保存到本地,用户重新打开应用时无需重新导入课表.

#### 日程自动推荐功能
* 双击日历中未被点击且本地没有相应数据的一天时,程序将会根据用户的`个性化设置`生成一个当天的基本日程规划,并且展示在日程表中,基本日程包含就餐和自习场所的信息.

* 当双击的一天已被规划或本地已经有数据时,右侧的日程表将会自动回到那天已有的日程规划,用户可以点击`重新安排`按钮对当天进行的日程进行重新安排.

#### 个性化事件推荐功能
* 点击`个性化推荐`按钮,程序将会自动生成$3$个推荐事件,并展示在弹出窗口中,用户可以点击其中的任意事件进行添加或`重开`按钮进行重新生成.

#### 日程本地保存功能
* 选定日历中的某一天时,我们可以点击`保存到本地`按钮,将当天的日程记录到本地,关闭程序重新打开后再次双击该天可以将日程切换为当天的日程.

#### 日程表交互
* 右键日程表任意一个位置会弹出包含`删除`,`添加`,`取消`,`修改`等四个按钮:点击`删除`会删除`当前行`;点击`添加`会弹出一个设置事件信息的窗口,设置完成后可以添加事件,如果添加的事件存在时间冲突会进行弹窗警告;点击`修改`则可以按照当前单元格的类别对当前单元格内容进行修改.

* 日程表下方有一个日程倒计时器,将会显示当前到日程表中的下一个日程的剩余事件,为了提醒用户及时通勤,将会在倒计时结束$10$分钟前响铃并弹窗提醒用户.

#### 讲座信息获取功能
* 选定日历中的一天时,点击`讲座信息`将会利用爬虫从北京大学讲座网中获取当天的讲座信息,并显示出来,帮助用户获取讲座信息,拓宽自己的眼界.

#### 手动倒计时功能

* 为了在内卷模式下提高用户的内卷效率,用户可以操作主界面左下方的倒计时器,手动设计一个倒计时,到时提醒用户.

### 个性化设置功能
* 点击`个性化设置`按钮将会弹出一个个性化设置界面,主要的各项功能如下:

#### 模式设置
* 用户可以选择合适的推荐模式:
1. `探索模式`(默认模式):在这个模式下,在`日程自动推荐功能`中,我们会采用智能的方式为用户规划自习和就餐的时间和地点,当我们勾选`记录并使用日程记录改进推荐`选项时,程序将会优先推荐用户前往那些前往次数较少的就餐和自习场所,当不勾选该选项时,程序将会随机进行推荐.

2. `内卷模式`:在这个模式下,在`日程自动推荐功能`中,程序会采用最短路径的原则为用户推荐自习和就餐地点,并且会将上午,下午,晚上没有课程的时间全部排满,提高用户的内卷效率.

3. `摆烂模式`:在这个模式下,用户可以获得酣畅淋漓的摆烂体验.

#### 偏好设置
* 用户可以勾选或者取消`日程自动推荐功能`中是否自动推荐早餐,中餐,晚餐的选项.

#### 杂项

1. 用户可以勾选`明确的答复`选项,关闭用户添加事件发生时间冲突时的弹窗提醒.

2. 用户可以修改宿舍位置,作为我们地图中路径的起始点和终止点.

3. 用户可以点击`倒计时设置`中的`修改图片`按钮,修改倒计时弹窗的图片.

4. 用户可以点击`清空历史记录`按钮,清空本地的课表,日程和访问记录等数据.

### 地图
* 点击主界面上方菜单栏中的`地图`项可以切换主界面至地图界面.

* 在地图界面中可以使用界面中的按钮``上一步``,``下一步``,``显示全部``,``隐藏全部``在地图上分步或一次性显示路径
### 说明
* 点击主界面上方菜单栏中的`说明`项会自动在浏览器中打开本项目的`Github仓库`,在这里用户可以查看`README`文档获取应用使用说明.

## 项目各模块与类设计细节

### 主界面模块
* 主界面模块主要包含日历,日程表(包含倒计时),课表导入三部分组成,由于彼此相互关联程度高,因此没有对它们做进一步的细分,我们可以分别介绍其相关设计细节.

#### 日历
* 当我们点击日历上任意一天时,会触发

#### 日程表
* 为了日程表高阶交互操作的构建方便,我们构建了一些基础接口例如`AddRow`,`AddCol`,`AddEvent`,`DeleteEvent`,在之后更为复杂的交互部分实现更加复杂的抽象.

* 当我们右键日程表中任意处时,会触发...接口,并弹出...选项


#### 课表导入


### 地图模块PKUMap
* 为了地图模块更高阶的交互的构建方便,我们首先定义了`ShowPath`,`HidePath`作为底层接口,它们接收一个整型参数`idx`表示我们的边的序号,分别用来显示/隐藏第`idx`条边.

* 地图模块中包含一个`QGraphicsScene*`指针,指向我们以燕园地图为像素图的一个`QGraphicsScene`对象,我们之后显示路径,添加滚轮功能等操作都是添加在这个`QGraphicsScene`上的.

* 设计了一个`WheelEventFilter`封闭类,过滤掉除鼠标滚轮外的信号,用于实现鼠标滚轮对图像的缩放,提升用户体验.

* 设计了一个`ArrowLine`封闭类,包含一个`paint`接口,用于绘制其在`ui`中可以表现为一个红色的箭头.

* 地图模块设置了四个按钮,每个按钮对应着一个槽函数,分别为`Prev`,`Next`,`ShowAll`,`HideAll`,用于逐步或者一次性显示/隐藏路径.其中路径会被保存在一个`ArrowLine*`类型的数组`_edges`内.

* 在地图模块中我们设计了`Update`接口用来维护地图界面右下角显示的信息,告诉用户当天的行程的总边数,以及目前展示的线段数.

### 事件类Event

### 设置模块Config

### 选择模块Selection

### 倒计时模块CountDownTimer

### 文件读写模块FileIO

### 爬虫模块

## 小组成员分工情况
* 徐海翁: 事件类`Event`,选择模块`Selection`,地图模块`PKUMap`,设置模块`Config`,文件读写模块`FileIO`等模块的设计和实现,主界面中日程自动推荐机制,手动个性化推荐功能的设计和实现,整合`Python`爬虫模块到`Qt`项目中.

* 黄源森: 主界面中日历和日程表高级交互的设计和实现,事件添加的通用模板设计,课表导入功能的设计和实现,倒计时`CountDownTimer`模块的设计和实现,利用`Python`和`Selenium`库模拟用户实际操作实现网络爬虫功能

* 谢宇翔: 日程倒计时机制的实现,菜单和主界面的`UI`美化.
## 项目总结与反思